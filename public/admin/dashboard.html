<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://unpkg.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: https://sh4nerewards.com https://res.cloudinary.com https://static.photos;
        connect-src 'self' https://sh4nerewards.com;
    ">
    <title>S4R Dashboard | Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-top: #07121a;
            --bg-bottom: #001017;
            --card-bg: #031016;
            --accent-cyan: #00E0FF;
            --accent-cyan-2: #72F4FF;
            --muted-white: #c7dfe6;
            --thumbnail-yellow: #ffd700;
            --thumbnail-green: #00ff66;
            --text-white: #ffffff;
            --neon-green: #00ff99;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bottom) 100%);
            color: var(--muted-white);
            min-height: 100vh;
            font-size: clamp(12px, 3vw, 14px);
            overflow-x: hidden;
        }

        body::-webkit-scrollbar, html { scrollbar-width: none; }
        body { -ms-overflow-style: none; }

        .bg-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle, transparent 0%, var(--bg-top) 90%),
                repeating-linear-gradient(45deg, rgba(3,22,25,0.18) 0px, rgba(3,22,25,0.18) 2px, transparent 2px, transparent 6px),
                repeating-linear-gradient(-45deg, rgba(3,22,25,0.18) 0px, rgba(3,22,25,0.18) 2px, transparent 2px, transparent 6px);
            filter: blur(4px);
            z-index: -1;
            opacity: 0.5;
        }

        .sidebar {
            background: var(--card-bg);
            transition: all 0.3s ease;
            width: 280px;
            border-right: 1px solid var(--accent-cyan);
        }

        .sidebar-collapsed { width: 80px; }
        .sidebar-collapsed .nav-text { display: none; }
        .content-expanded { margin-left: 80px; }

        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--accent-cyan);
            backdrop-filter: blur(6px);
            transition: all 0.25s cubic-bezier(.2,.9,.3,1);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0,224,255,0.28);
        }

        .notification-dot {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .cta-button {
            background: rgba(167, 236, 255, 1);
            color: #021d22;
            border-radius: 15px;
            border: 1px solid var(--accent-cyan);
            padding: 12px 24px;
            font-weight: 900;
            font-size: clamp(10px, 2.5vw, 12px);
            transition: all 0.18s cubic-bezier(.2,.9,.3,1);
        }

        .cta-button:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0,224,255,0.48);
        }

        .chart-container {
            background: rgba(10, 30, 40, 0.5);
            border: 1px solid var(--accent-cyan);
            backdrop-filter: blur(6px);
        }

        .modal {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
        }

        .input-error {
            border: 1px solid #ff4d4f !important;
        }

        .error-message {
            background: rgba(255, 77, 79, 0.1);
            padding: 8px;
            border-radius: 4px;
        }

        iframe {
            border: none;
            width: 100%;
            height: 100%;
            background: var(--card-bg);
        }

        .loading-modal {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            inset: 0;
            z-index: 100;
        }

        .svg-frame {
            position: relative;
            width: 100px;
            height: 100px;
            transform-style: preserve-3d;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .svg-frame svg {
            position: absolute;
            transition: 0.1s;
            z-index: calc(1 - (0.2 * var(--j)));
            transform-origin: center;
            width: 344px;
            height: 344px;
            fill: none;
        }

        .svg-frame:hover svg {
            transform: rotate(-80deg) skew(30deg) translateX(calc(45px * var(--i))) translateY(calc(-35px * var(--i)));
        }

        .svg-frame svg #center {
            transition: 0.1s;
            transform-origin: center;
        }

        .svg-frame:hover svg #center {
            transform: rotate(-30deg) translateX(45px) translateY(-3px);
        }

        #out2 {
            animation: rotate16 2s ease-in-out infinite alternate;
            transform-origin: center;
        }

        #out3 {
            animation: rotate16 2s ease-in-out infinite alternate;
            transform-origin: center;
            stroke: #ff0;
        }

        #inner3,
        #inner1 {
            animation: rotate16 1s ease-in-out infinite alternate;
            transform-origin: center;
        }

        #center1 {
            fill: #ff0;
            animation: rotate16 1s ease-in-out infinite alternate;
            transform-origin: center;
        }

        @keyframes rotate16 {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div class="sidebar shadow-lg z-10 flex-shrink-0" id="sidebar">
            <div class="flex flex-col h-full">
                <div class="flex items-center justify-between p-4 border-b border-[var(--accent-cyan)]">
                    <div class="flex items-center">
                        <span class="ml-3 text-xl font-bold text-[var(--accent-cyan)] nav-text">S4R-Admin</span>
                    </div>
                    <button id="sidebar-toggle" class="text-[var(--muted-white)] hover:text-[var(--accent-cyan)]">
                        <i data-feather="chevron-left" class="w-5 h-5"></i>
                    </button>
                </div>
                <nav class="flex-1 overflow-y-auto mt-4">
                    <div class="px-4 space-y-1">
                        <a href="javascript:void(0)" data-page="dashboard-content.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg bg-[rgba(0,224,255,0.2)] text-[var(--accent-cyan)]">
                            <i data-feather="home" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Dashboard</span>
                        </a>
                        <a href="javascript:void(0)" data-page="leaderboard.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="award" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Leaderboard</span>
                            <span id="leaderboard-count" class="ml-auto px-2 py-0.5 text-xs font-medium rounded-full bg-[rgba(0,224,255,0.2)] text-[var(--accent-cyan)]">0</span>
                        </a>
                        <a href="javascript:void(0)" data-page="shorts.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="video" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Shorts</span>
                        </a>
                        <a href="javascript:void(0)" data-page="videos.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="film" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Videos</span>
                        </a>
                        <a href="javascript:void(0)" data-page="reviews.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="star" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Reviews</span>
                            <span id="review-count" class="ml-auto px-2 py-0.5 text-xs font-medium rounded-full bg-[rgba(0,224,255,0.2)] text-[var(--accent-cyan)]">0</span>
                        </a>
                        <a href="javascript:void(0)" data-page="schedule.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="calendar" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Schedule</span>
                            <span id="schedule-count" class="ml-auto px-2 py-0.5 text-xs font-medium rounded-full bg-[rgba(0,224,255,0.2)] text-[var(--accent-cyan)]">0</span>
                        </a>
                        <a href="javascript:void(0)" data-page="giveaways.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="award" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Giveaways</span>
                            <span id="entry-count" class="ml-auto notification-dot bg-[var(--thumbnail-yellow)] h-2 w-2 rounded-full"></span>
                        </a>
                        <a href="javascript:void(0)" data-page="contacts.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="message-square" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Contacts</span>
                            <span id="contact-count" class="ml-auto px-2 py-0.5 text-xs font-medium rounded-full bg-[rgba(0,224,255,0.2)] text-[var(--accent-cyan)]">0</span>
                        </a>
                        <a href="javascript:void(0)" data-page="visitors.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="users" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Visitors</span>
                        </a>
                        <a href="javascript:void(0)" data-page="link-clicks.html" class="nav-link flex items-center px-4 py-3 text-sm font-medium rounded-lg text-[var(--muted-white)] hover:bg-[rgba(0,224,255,0.1)]">
                            <i data-feather="link" class="w-5 h-5 text-[var(--text-white)]"></i>
                            <span class="ml-3 nav-text">Link Clicks</span>
                        </a>
                    </div>
                </nav>
                <div class="p-4 border-t border-[var(--accent-cyan)]">
                    <div class="flex items-center">
                        <img src="img/Sh4ner_White 1.png" alt="User" class="h-10 w-10 rounded-full">
                        <div class="ml-3 nav-text">
                            <p class="text-sm font-medium text-[var(--text-white)]">SH4NER</p>
                            <p class="text-xs text-[var(--muted-white)]">Partner Streamer</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-auto content-expanded" id="main-content">
            <iframe id="content-frame" src="dashboard-content.html" class="w-full h-full"></iframe>
        </div>
    </div>

    <!-- Block modal for mobile or no internet -->
    <div id="block-modal" class="fixed inset-0 z-[9999] hidden bg-black/80 backdrop-blur-sm text-white text-center">
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center justify-center bg-[#0d1117] border border-cyan-400 rounded-2xl shadow-2xl p-8 max-w-md w-[90%] space-y-4 animate-fadeIn">
            <h1 id="block-title" class="text-2xl font-bold text-cyan-400">Checking connection...</h1>
            <p id="block-message" class="text-gray-300 text-sm">Please wait a moment king...</p>
            <div id="countdown" class="text-cyan-300 text-lg font-semibold mt-3"></div>
        </div>
    </div>

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const blockModal = document.getElementById('block-modal');
            const title = document.getElementById('block-title');
            const message = document.getElementById('block-message');
            const countdownEl = document.getElementById('countdown');

            // ✅ Use screen size detection (CSS media query)
            const smallScreen = window.matchMedia("(max-width: 1024px)").matches;

            // 🚫 Restrict small screens instantly
            if (smallScreen) {
                showBlock("Hey king 👑", "You can only use PC (large screen) to view admin for better statistic.");
                return;
            }

            // ✅ Internet connection watcher
            function updateOnlineStatus() {
                if (!navigator.onLine) {
                    showBlock("Sorry king 😔", "You don’t have internet connection.");
                } else {
                    hideBlock();
                }
            }

            // 🧩 Show modal with countdown
            function showBlock(titleText, messageText) {
                let count = 10;
                title.textContent = titleText;
                message.textContent = messageText;
                blockModal.classList.remove('hidden');
                countdownEl.textContent = `Rechecking in ${count}s...`;

                const interval = setInterval(() => {
                    count--;
                    countdownEl.textContent = `Rechecking in ${count}s...`;
                    if (count <= 0) {
                        clearInterval(interval);
                        if (navigator.onLine && !window.matchMedia("(max-width: 1024px)").matches) {
                            hideBlock();
                        } else {
                            showBlock(titleText, messageText);
                        }
                    }
                }, 1000);
            }

            // 💨 Hide the modal
            function hideBlock() {
                blockModal.classList.add('hidden');
            }

            // 🌐 Watch for connection changes
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);

            // 📏 Watch for screen resize (if user resizes to mobile)
            window.addEventListener('resize', () => {
                if (window.matchMedia("(max-width: 1024px)").matches) {
                    showBlock("Hey king 👑", "You can only use PC (large screen) to view admin for better statistic.");
                }
            });

            // ⚡ Initial status check
            updateOnlineStatus();
        });
    </script>

    <!-- Loading Modal -->
    <div id="loading-modal" class="loading-modal hidden">
        <div class="svg-frame">
            <svg style="--i:0;--j:0;">
                <g id="out1">
                    <path
                        d="M72 172C72 116.772 116.772 72 172 72C227.228 72 272 116.772 272 172C272 227.228 227.228 272 172 272C116.772 272 72 227.228 72 172ZM197.322 172C197.322 158.015 185.985 146.678 172 146.678C158.015 146.678 146.678 158.015 146.678 172C146.678 185.985 158.015 197.322 172 197.322C185.985 197.322 197.322 185.985 197.322 172Z"
                    ></path>
                    <path
                        d="M72 172C72 116.772 116.772 72 172 72C227.228 72 272 116.772 272 172C272 227.228 227.228 272 172 272C116.772 272 72 227.228 72 172ZM197.322 172C197.322 158.015 185.985 146.678 172 146.678C158.015 146.678 146.678 158.015 146.678 172C146.678 185.985 158.015 197.322 172 197.322C185.985 197.322 197.322 185.985 197.322 172Z"
                        stroke="#00FFFF"
                        stroke-width="2"
                        stroke-miterlimit="16"
                        mask="url(#path-1-inside-1_111_3212)"
                    ></path>
                </g>
            </svg>
            <svg style="--i:1;--j:1;">
                <g id="out2">
                    <mask id="path-2-inside-2_111_3212" fill="white">
                        <path
                            d="M102.892 127.966C93.3733 142.905 88.9517 160.527 90.2897 178.19L94.3752 177.88C93.1041 161.1 97.3046 144.36 106.347 130.168L102.892 127.966Z"
                        ></path>
                        <path
                            d="M93.3401 194.968C98.3049 211.971 108.646 226.908 122.814 237.541L125.273 234.264C111.814 224.163 101.99 209.973 97.2731 193.819L93.3401 194.968Z"
                        ></path>
                        <path
                            d="M152.707 92.3592C140.33 95.3575 128.822 101.199 119.097 109.421L121.742 112.55C130.981 104.739 141.914 99.1897 153.672 96.3413L153.672 96.3413Z"
                        ></path>
                        <path
                            d="M253.294 161.699C255.099 175.937 253.132 190.4 247.59 203.639L243.811 202.057C249.075 189.48 250.944 175.74 249.23 162.214L253.294 161.699Z"
                        ></path>
                        <path
                            d="M172 90.0557C184.677 90.0557 197.18 92.9967 208.528 98.6474C219.875 104.298 229.757 112.505 237.396 122.621L234.126 125.09C226.869 115.479 217.481 107.683 206.701 102.315C195.921 96.9469 184.043 94.1529 172 94.1529V90.0557Z"
                        ></path>
                        <path
                            d="M244.195 133.235C246.991 138.442 249.216 143.937 250.83 149.623L246.888 150.742C245.355 145.34 243.242 140.12 240.586 135.174L244.195 133.235Z"
                        ></path>
                        <path
                            d="M234.238 225.304C223.932 237.338 210.358 246.126 195.159 250.604C179.961 255.082 163.79 255.058 148.606 250.534L149.775 246.607C164.201 250.905 179.563 250.928 194.001 246.674C208.44 242.420 221.335 234.071 231.126 222.639L234.238 225.304Z"
                        ></path>
                    </mask>
                    <path
                        d="M102.892 127.966L105.579 123.75L101.362 121.063L98.6752 125.28L102.892 127.966ZM90.2897 178.19L85.304 178.567L85.6817 183.553L90.6674 183.175L90.2897 178.19ZM94.3752 177.88L94.7529 182.866L99.7386 182.488L99.3609 177.503L94.3752 177.88ZM106.347 130.168L110.564 132.855L113.251 128.638L109.034 125.951L106.347 130.168ZM93.3401 194.968L91.9387 190.168L87.1391 191.569L88.5405 196.369L93.3401 194.968ZM122.814 237.541L119.813 241.54L123.812 244.541L126.813 240.542L122.814 237.541ZM125.273 234.264L129.272 237.265L132.273 233.266L128.274 230.265L125.273 234.264ZM97.2731 193.819L102.073 192.418L100.671 187.618L95.8717 189.02L97.2731 193.819ZM152.707 92.3592L157.567 91.182L156.389 86.3226L151.3 87.4998L152.707 92.3592ZM119.097 109.421L115.869 105.603L112.05 108.831L115.278 112.649L119.097 109.421ZM121.742 112.55L117.924 115.778L121.152 119.596L124.97 116.368L121.742 112.55ZM153.672 96.3413L154.849 101.201L159.708 100.023L158.531 95.1641L153.672 96.3413ZM253.294 161.699L258.255 161.07L257.626 156.11L252.666 156.738L253.294 161.699ZM247.59 203.639L245.66 208.251L250.272 210.182L252.203 205.569L247.59 203.639ZM243.811 202.057L239.198 200.126L237.268 204.739L241.88 206.669L243.811 202.057ZM249.23 162.214L248.601 157.253L243.641 157.882L244.269 162.842L249.23 162.214ZM172 90.0557C184.677 90.0557 197.18 92.9967 208.528 98.6474C219.875 104.298 229.757 112.505 237.396 122.621L234.126 125.09C226.869 115.479 217.481 107.683 206.701 102.315C195.921 96.9469 184.043 94.1529 172 94.1529V90.0557Z"
                        fill="#00FFFF"
                        mask="url(#path-2-inside-2_111_3212)"
                    ></path>
                </g>
            </svg>
            <svg style="--i:0;--j:2;">
                <g id="inner3">
                    <path
                        d="M195.136 135.689C188.115 131.215 179.948 128.873 171.624 128.946C163.299 129.019 155.174 131.503 148.232 136.099L148.42 136.382C155.307 131.823 163.368 129.358 171.627 129.286C179.886 129.213 187.988 131.537 194.954 135.975L195.136 135.689Z"
                    ></path>
                    <path
                        d="M195.136 208.311C188.115 212.784 179.948 215.127 171.624 215.054C163.299 214.981 155.174 212.496 148.232 207.901L148.42 207.618C155.307 212.177 163.368 214.642 171.627 214.714C179.886 214.786 187.988 212.463 194.954 208.025L195.136 208.311Z"
                    ></path>
                    <path
                        d="M195.136 135.689L195.474 135.904L195.689 135.566L195.351 135.352L195.136 135.689ZM171.624 128.946L171.627 129.346L171.624 128.946ZM148.232 136.099L148.011 135.765L147.678 135.986L147.899 136.32L148.232 136.099ZM148.42 136.382L148.086 136.603L148.307 136.936L148.641 136.716L148.42 136.382ZM171.627 129.286L171.63 129.686L171.627 129.286ZM194.954 135.975L194.739 136.313L195.076 136.528L195.291 136.19L194.954 135.975ZM195.136 208.311L195.351 208.648L195.689 208.433L195.474 208.096L195.136 208.311ZM171.624 215.054L171.627 214.654L171.624 215.054ZM148.232 207.901L147.899 207.68L147.678 208.014L148.011 208.234L148.232 207.901ZM148.42 207.618L148.641 207.284L148.307 207.063L148.086 207.397L148.42 207.618ZM171.627 214.714L171.63 214.314L171.627 214.714ZM194.954 208.025L195.291 207.81L195.076 207.472L194.739 207.687L194.954 208.025ZM195.351 135.352C188.265 130.836 180.022 128.473 171.62 128.546L171.627 129.346C179.874 129.274 187.966 131.594 194.921 136.026L195.351 135.352ZM171.62 128.546C163.218 128.619 155.018 131.127 148.011 135.765L148.453 136.432C155.33 131.88 163.38 129.418 171.627 129.346L171.62 128.546ZM147.899 136.32L148.086 136.603L148.753 136.161L148.566 135.878L147.899 136.32ZM148.641 136.716C155.463 132.199 163.448 129.757 171.63 129.686L171.623 128.886C163.287 128.958 155.15 131.447 148.199 136.049L148.641 136.716ZM171.63 129.686C179.812 129.614 187.839 131.916 194.739 136.313L195.169 135.638C188.138 131.158 179.959 128.813 171.623 128.886L171.63 129.686ZM195.291 136.19L195.474 135.904L194.799 135.474L194.617 135.76L195.291 136.19ZM194.921 207.974C187.966 212.406 179.874 214.726 171.627 214.654L171.62 215.454C180.022 215.527 188.265 213.163 195.351 208.648L194.921 207.974ZM171.627 214.654C163.380 214.582 155.33 212.120 148.453 207.567L148.011 208.234C155.018 212.873 163.218 215.380 171.62 215.454L171.627 214.654ZM148.566 208.122L148.753 207.838L148.086 207.397L147.899 207.68L148.566 208.122ZM148.199 207.951C155.15 212.553 163.287 215.041 171.623 215.114L171.63 214.314C163.448 214.243 155.463 211.801 148.641 207.284L148.199 207.951ZM171.623 215.114C179.959 215.187 188.138 212.842 195.169 208.362L194.739 207.687C187.839 212.084 179.812 214.386 171.63 214.314L171.623 215.114ZM194.617 208.239L194.799 208.526L195.474 208.096L195.291 207.81L194.617 208.239Z"
                        fill="#00FFFF"
                        mask="url(#path-5-inside-3_111_3212)"
                    ></path>
                    <path
                        id="out3"
                        d="M240.944 172C240.944 187.951 235.414 203.408 225.295 215.738C215.176 228.068 201.095 236.508 185.45 239.62C169.806 242.732 153.567 240.323 139.5 232.804C125.433 225.285 114.408 213.12 108.304 198.384C102.2 183.648 101.394 167.25 106.024 151.987C110.654 136.723 120.434 123.537 133.696 114.675C146.959 105.813 162.884 101.824 178.758 103.388C194.632 104.951 209.472 111.97 220.751 123.249"
                        stroke="#00FFFF"
                    ></path>
                </g>
                <path
                    id="inner1"
                    d="M145.949 124.51L148.554 129.259C156.575 124.859 165.672 122.804 174.806 123.331C183.94 123.858 192.741 126.944 200.203 132.236C207.665 137.529 213.488 144.815 217.004 153.261C220.521 161.707 221.59 170.972 220.09 179.997L224.108 180.665L224.102 180.699L229.537 181.607C230.521 175.715 230.594 169.708 229.753 163.795L225.628 164.381C224.987 159.867 223.775 155.429 222.005 151.179C218.097 141.795 211.628 133.699 203.337 127.818C195.045 121.937 185.266 118.508 175.118 117.923C165.302 117.357 155.525 119.474 146.83 124.037C146.535 124.192 146.241 124.349 145.949 124.51ZM224.638 164.522C224.009 160.091 222.819 155.735 221.082 151.563C217.246 142.352 210.897 134.406 202.758 128.634C194.62 122.862 185.021 119.496 175.06 118.922C165.432 118.367 155.841 120.441 147.311 124.914L148.954 127.91C156.922 123.745 165.876 121.814 174.864 122.333C184.185 122.870 193.166 126.019 200.782 131.421C208.397 136.822 214.339 144.257 217.928 152.877C221.388 161.188 222.526 170.276 221.23 179.173L224.262 179.677C224.998 174.671 225.35 169.535 224.638 164.522Z"
                    fill="#00FFFF"
                ></path>
                <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M139.91 220.713C134.922 217.428 130.469 213.395 126.705 208.758L130.983 205.286L130.985 205.288L134.148 202.721C141.342 211.584 151.417 217.642 162.619 219.839C173.821 222.036 185.438 220.232 195.446 214.742L198.051 219.491C197.759 219.651 197.465 219.809 197.17 219.963C186.252 225.693 173.696 227.531 161.577 225.154C154.613 223.789 148.041 221.08 142.202 217.234L139.91 220.713ZM142.752 216.399C148.483 220.174 154.934 222.833 161.769 224.173C173.658 226.504 185.977 224.704 196.689 219.087L195.046 216.09C185.035 221.323 173.531 222.998 162.427 220.82C151.323 218.643 141.303 212.747 134.01 204.122L131.182 206.5C134.451 210.376 138.515 213.607 142.752 216.399Z"
                    fill="#00FFFF"
                ></path>
                <path
                    id="center1"
                    d="M180.956 186.056C183.849 184.212 186.103 181.521 187.41 178.349C188.717 175.177 189.013 171.679 188.258 168.332C187.503 164.986 185.734 161.954 183.192 159.65C180.649 157.346 177.458 155.883 174.054 155.46C170.649 155.038 167.197 155.676 164.169 157.288C161.140 158.9 158.683 161.407 157.133 164.468C155.582 167.528 155.014 170.992 155.505 174.388C155.997 177.783 157.524 180.944 159.879 183.439L161.129 182.259C159.018 180.021 157.648 177.186 157.207 174.141C156.766 171.096 157.276 167.989 158.667 165.245C160.057 162.5 162.261 160.252 164.977 158.806C167.693 157.36 170.788 156.788 173.842 157.167C176.895 157.546 179.757 158.858 182.037 160.924C184.317 162.99 185.904 165.709 186.581 168.711C187.258 171.712 186.992 174.849 185.82 177.694C184.648 180.539 182.627 182.952 180.032 184.606L180.956 186.056Z"
                    fill="#ff0"
                ></path>
                <path
                    id="center"
                    d="M172 166.445C175.068 166.445 177.556 168.932 177.556 172C177.556 175.068 175.068 177.556 172 177.556C168.932 177.556 166.444 175.068 166.444 172C166.444 168.932 168.932 166.445 172 166.445ZM172 177.021C174.773 177.021 177.021 174.773 177.021 172C177.021 169.227 174.773 166.979 172 166.979C169.227 166.979 166.979 169.227 166.979 172C166.979 174.773 169.227 177.021 172 177.021Z"
                    fill="#00FFFF"
                ></path>
            </svg>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 modal hidden flex items-center justify-center z-50">
        <div class="bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--accent-cyan)] w-full max-w-md">
            <h2 class="text-lg font-medium text-[var(--text-white)] mb-4">Login</h2>
            <div id="login-error" class="hidden text-sm text-red-600 mb-4 error-message"></div>
            <div class="space-y-4">
                <input id="login-email" type="email" placeholder="Email" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="login-password" type="password" placeholder="Password" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <div class="flex justify-end space-x-2">
                    <button id="login-submit" class="cta-button">Login</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Credentials Modal -->
    <div id="update-credentials-modal" class="fixed inset-0 modal hidden flex items-center justify-center z-50">
        <div class="bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--accent-cyan)] w-full max-w-md">
            <h2 class="text-lg font-medium text-[var(--text-white)] mb-4">Update Credentials</h2>
            <p class="text-sm text-[var(--muted-white)] mb-4">Please update your email and password. Password must be at least 8 characters, including one uppercase, one lowercase, one number, and one special character.</p>
            <div id="update-credentials-error" class="hidden text-sm text-red-600 mb-4 error-message"></div>
            <div class="space-y-4">
                <input id="update-old-email" type="email" placeholder="Current Email" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="update-current-password" type="password" placeholder="Current Password" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="update-new-email" type="email" placeholder="New Email" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="update-new-password" type="password" placeholder="New Password" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <div class="flex justify-end space-x-2">
                    <button id="update-credentials-cancel" class="px-4 py-2 text-[var(--muted-white)] hover:text-[var(--accent-cyan)]">Cancel</button>
                    <button id="update-credentials-submit" class="cta-button">Update</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Form Modal -->
    <div id="contact-modal" class="fixed inset-0 modal hidden flex items-center justify-center z-50">
        <div class="bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--accent-cyan)] w-full max-w-md">
            <h2 class="text-lg font-medium text-[var(--text-white)] mb-4">Submit Contact</h2>
            <div id="contact-error" class="hidden text-sm text-red-600 mb-4 error-message"></div>
            <div class="space-y-4">
                <input id="contact-firstName" type="text" placeholder="First Name" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="contact-lastName" type="text" placeholder="Last Name" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="contact-email" type="email" placeholder="Email" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="contact-phone" type="text" placeholder="Phone (Optional)" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <textarea id="contact-message" placeholder="Message" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]" rows="4"></textarea>
                <div class="flex justify-end space-x-2">
                    <button id="contact-cancel" class="px-4 py-2 text-[var(--muted-white)] hover:text-[var(--accent-cyan)]">Cancel</button>
                    <button id="contact-submit" class="cta-button">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Giveaway Entry Modal -->
    <div id="giveaway-modal" class="fixed inset-0 modal hidden flex items-center justify-center z-50">
        <div class="bg-[var(--card-bg)] p-6 rounded-lg border border-[var(--accent-cyan)] w-full max-w-md">
            <h2 class="text-lg font-medium text-[var(--text-white)] mb-4">Enter Giveaway</h2>
            <div id="giveaway-error" class="hidden text-sm text-red-600 mb-4 error-message"></div>
            <div class="space-y-4">
                <input id="giveaway-email" type="email" placeholder="Email" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="giveaway-depositAmount" type="number" placeholder="Deposit Amount ($, min 20)" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <input id="giveaway-prize" type="text" placeholder="Prize (Optional)" class="w-full px-3 py-2 bg-[var(--card-bg)] border border-[var(--accent-cyan)] rounded-md text-[var(--text-white)]">
                <div class="flex justify-end space-x-2">
                    <button id="giveaway-cancel" class="px-4 py-2 text-[var(--muted-white)] hover:text-[var(--accent-cyan)]">Cancel</button>
                    <button id="giveaway-submit" class="cta-button">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Embedded leaderboard data as fallback
        const fallbackLeaderboardData = [
            { rank: 1, username: "ЖЕ*****ЧУ", totalWager: 243747.58, reward: 3000, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 2, username: "Ma***ts", totalWager: 205427.81, reward: 2000, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 3, username: "Lb*******yb", totalWager: 97128.16, reward: 1000, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 4, username: "El********cc", totalWager: 94694.31, reward: 500, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 5, username: "St********ac", totalWager: 68815, reward: 250, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 6, username: "Ma*****f5", totalWager: 35404.04, reward: 250, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 7, username: "Ki**_K", totalWager: 13919.21, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 8, username: "Ma*****ay", totalWager: 13235.44, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 9, username: "Re**im", totalWager: 11396.51, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 10, username: "Ng******ri", totalWager: 10468.95, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 11, username: "اب***کل", totalWager: 9752.73, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 12, username: "Az******🚬", totalWager: 7833.94, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 13, username: "ᘻᓍ******🎭", totalWager: 6474.33, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 14, username: "Tr******oa", totalWager: 6094.99, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 15, username: "Sa**********te", totalWager: 5830.2, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 16, username: "Bu**********ze", totalWager: 5253.2, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 17, username: "Br***um", totalWager: 4680, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 18, username: "सा************🚩", totalWager: 4331.13, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 19, username: "ih*****fe", totalWager: 4240, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
            { rank: 20, username: "La*****25", totalWager: 3588.75, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" }
        ];

        feather.replace();

        // Sidebar toggle
        document.getElementById('sidebar-toggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            sidebar.classList.toggle('sidebar-collapsed');
            mainContent.classList.toggle('content-expanded');
            const icon = this.querySelector('i');
            if (icon) {
                icon.setAttribute('data-feather', sidebar.classList.contains('sidebar-collapsed') ? 'chevron-right' : 'chevron-left');
                feather.replace();
            }
        });

        // Sidebar navigation with loading modal
        const iframe = document.getElementById('content-frame');
        const loadingModal = document.getElementById('loading-modal');
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function() {
                const page = this.getAttribute('data-page');
                loadingModal.classList.remove('hidden');
                iframe.src = page;
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('bg-[rgba(0,224,255,0.2)]', 'text-[var(--accent-cyan)]'));
                this.classList.add('bg-[rgba(0,224,255,0.2)]', 'text-[var(--accent-cyan)]');
            });
        });

        iframe.addEventListener('load', () => {
            setTimeout(() => {
                loadingModal.classList.add('hidden');
            }, 500);
        });

        // Show login modal on page load if not authenticated
        document.addEventListener('DOMContentLoaded', () => {
            if (!localStorage.getItem('authToken')) {
                document.getElementById('login-modal').classList.remove('hidden');
            }
        });

        // Client-side password validation
        function validatePassword(password) {
            const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
            return passwordRegex.test(password);
        }

        // Login form handling
        document.getElementById('login-submit').addEventListener('click', async () => {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const errorDiv = document.getElementById('login-error');

            if (!email || !password) {
                errorDiv.textContent = 'Please provide both email and password';
                errorDiv.classList.remove('hidden');
                document.getElementById('login-email').classList.toggle('input-error', !email);
                document.getElementById('login-password').classList.toggle('input-error', !password);
                return;
            }

            try {
                const response = await fetch('https://sh4nerewards.com/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.error || `Login failed: ${response.status}`);
                }
                localStorage.setItem('authToken', result.token);
                alert('Login successful!');
                document.getElementById('login-modal').classList.add('hidden');
                document.getElementById('login-email').value = '';
                document.getElementById('login-password').value = '';
                document.getElementById('login-error').classList.add('hidden');
                document.getElementById('login-email').classList.remove('input-error');
                document.getElementById('login-password').classList.remove('input-error');
                if (result.isDefault) {
                    alert('You are using default credentials. Please update your email and password.');
                    document.getElementById('update-old-email').value = email;
                    document.getElementById('update-credentials-modal').classList.remove('hidden');
                }
                fetchStats(); // Refresh stats after login
            } catch (err) {
                console.error('Error during login:', err);
                errorDiv.textContent = err.message || 'Failed to login';
                errorDiv.classList.remove('hidden');
            }
        });

        document.getElementById('login-cancel').addEventListener('click', () => {
            document.getElementById('login-modal').classList.add('hidden');
            document.getElementById('login-error').classList.add('hidden');
            document.getElementById('login-email').value = '';
            document.getElementById('login-password').value = '';
            document.getElementById('login-email').classList.remove('input-error');
            document.getElementById('login-password').classList.remove('input-error');
        });

        // Update credentials form handling
        document.getElementById('update-credentials-submit').addEventListener('click', async () => {
            const oldEmail = document.getElementById('update-old-email').value.trim();
            const currentPassword = document.getElementById('update-current-password').value.trim();
            const newEmail = document.getElementById('update-new-email').value.trim();
            const newPassword = document.getElementById('update-new-password').value.trim();
            const errorDiv = document.getElementById('update-credentials-error');

            // Reset error states
            document.getElementById('update-old-email').classList.remove('input-error');
            document.getElementById('update-current-password').classList.remove('input-error');
            document.getElementById('update-new-email').classList.remove('input-error');
            document.getElementById('update-new-password').classList.remove('input-error');
            errorDiv.classList.add('hidden');

            if (!oldEmail || !currentPassword || !newEmail || !newPassword) {
                errorDiv.textContent = 'Please provide all required fields';
                errorDiv.classList.remove('hidden');
                document.getElementById('update-old-email').classList.toggle('input-error', !oldEmail);
                document.getElementById('update-current-password').classList.toggle('input-error', !currentPassword);
                document.getElementById('update-new-email').classList.toggle('input-error', !newEmail);
                document.getElementById('update-new-password').classList.toggle('input-error', !newPassword);
                return;
            }

            if (!validatePassword(newPassword)) {
                errorDiv.textContent = 'New password must be at least 8 characters long and include one uppercase letter, one lowercase letter, one number, and one special character (@$!%*?&)';
                errorDiv.classList.remove('hidden');
                document.getElementById('update-new-password').classList.add('input-error');
                return;
            }

            try {
                const response = await fetch('https://sh4nerewards.com/api/update-credentials', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('authToken')}`
                    },
                    body: JSON.stringify({ oldEmail, currentPassword, newEmail, newPassword })
                });
                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.error || `Update credentials failed: ${response.status}`);
                }
                localStorage.removeItem('authToken'); // Clear token as session is invalidated
                alert('Credentials updated successfully! Please log in with your new credentials.');
                document.getElementById('update-credentials-modal').classList.add('hidden');
                document.getElementById('update-old-email').value = '';
                document.getElementById('update-current-password').value = '';
                document.getElementById('update-new-email').value = '';
                document.getElementById('update-new-password').value = '';
                document.getElementById('update-credentials-error').classList.add('hidden');
                document.getElementById('login-modal').classList.remove('hidden'); // Prompt re-login
            } catch (err) {
                console.error('Error updating credentials:', err);
                errorDiv.textContent = err.message || 'Failed to update credentials';
                errorDiv.classList.remove('hidden');
                if (err.message.includes('Invalid or expired token') || err.message.includes('Unauthorized')) {
                    localStorage.removeItem('authToken');
                    document.getElementById('login-modal').classList.remove('hidden');
                }
            }
        });

        document.getElementById('update-credentials-cancel').addEventListener('click', () => {
            document.getElementById('update-credentials-modal').classList.add('hidden');
            document.getElementById('update-credentials-error').classList.add('hidden');
            document.getElementById('update-old-email').value = '';
            document.getElementById('update-current-password').value = '';
            document.getElementById('update-new-email').value = '';
            document.getElementById('update-new-password').value = '';
            document.getElementById('update-old-email').classList.remove('input-error');
            document.getElementById('update-current-password').classList.remove('input-error');
            document.getElementById('update-new-email').classList.remove('input-error');
            document.getElementById('update-new-password').classList.remove('input-error');
        });

        // Track visitor on page load
        async function trackVisitor() {
            try {
                const response = await fetch('https://sh4nerewards.com/api/tracking/trackVisitor', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ sessionId: Date.now().toString() })
                });
                if (!response.ok) {
                    throw new Error(`Visitor API failed: ${response.status}`);
                }
            } catch (err) {
                console.error('Error tracking visitor:', err);
            }
        }

        // Fetch and display stats for sidebar counters
        async function fetchStats() {
            try {
                const token = localStorage.getItem('authToken');
                const headers = { 'Content-Type': 'application/json' };
                if (token) {
                    headers['Authorization'] = `Bearer ${token}`;
                }
                const [contactsResponse, entriesResponse, scheduleResponse, leaderboardResponse, slotReviewsResponse, casinoReviewsResponse] = await Promise.all([
                    fetch('https://sh4nerewards.com/api/contact?cacheBust=' + Date.now(), { headers }).catch((err) => {
                        console.error('Contact API fetch failed:', err);
                        return { ok: false, status: 500 };
                    }),
                    fetch('https://sh4nerewards.com/api/giveaway/entries?cacheBust=' + Date.now(), { headers }).catch((err) => {
                        console.error('Giveaway Entries API fetch failed:', err);
                        return { ok: false, status: 500 };
                    }),
                    fetch('https://sh4nerewards.com/api/schedule?cacheBust=' + Date.now(), { headers }).catch((err) => {
                        console.error('Schedule API fetch failed:', err);
                        return { ok: false, status: 500 };
                    }),
                    fetch('https://sh4nerewards.com/api/leaderboard?cacheBust=' + Date.now()).catch((err) => {
                        console.error('Leaderboard API fetch failed:', err);
                        return { ok: false, status: 500 };
                    }),
                    fetch('https://sh4nerewards.com/api/reviews?type=slot&cacheBust=' + Date.now(), { headers }).then(res => res.ok ? res.json() : []).then(data => data.reviews || []).catch((err) => {
                        console.error('Slot Reviews API fetch failed:', err);
                        return [];
                    }),
                    fetch('https://sh4nerewards.com/api/reviews?type=casino&cacheBust=' + Date.now(), { headers }).then(res => res.ok ? res.json() : []).then(data => data.reviews || []).catch((err) => {
                        console.error('Casino Reviews API fetch failed:', err);
                        return [];
                    })
                ]);

                if (contactsResponse.status === 401 || entriesResponse.status === 401 || scheduleResponse.status === 401) {
                    localStorage.removeItem('authToken');
                    document.getElementById('login-modal').classList.remove('hidden');
                    return;
                }

                const contacts = contactsResponse.ok ? await contactsResponse.json().catch((err) => {
                    console.error('Contact JSON parse error:', err);
                    return [];
                }) : [];
                const entries = entriesResponse.ok ? await entriesResponse.json().catch((err) => {
                    console.error('Giveaway Entries JSON parse error:', err);
                    return [];
                }) : [];
                const schedule = scheduleResponse.ok ? (await scheduleResponse.json()).schedule || [] : [];
                const leaderboard = leaderboardResponse.ok ? (await leaderboardResponse.json()).data || [] : fallbackLeaderboardData;
                const reviews = [...(slotReviewsResponse || []), ...(casinoReviewsResponse || [])];

                console.log('Contacts response (sidebar):', {
                    status: contactsResponse.status,
                    ok: contactsResponse.ok,
                    headers: contactsResponse.ok ? Object.fromEntries(contactsResponse.headers.entries()) : {},
                    body: contacts
                });

                document.getElementById('contact-count').textContent = contacts.length || '0';
                document.getElementById('contact-count').classList.toggle('hidden', !contacts.length);
                document.getElementById('entry-count').textContent = entries.length || '0';
                document.getElementById('entry-count').classList.toggle('hidden', !entries.length);
                document.getElementById('schedule-count').textContent = schedule.length || '0';
                document.getElementById('schedule-count').classList.toggle('hidden', !schedule.length);
                document.getElementById('leaderboard-count').textContent = leaderboard.length || '0';
                document.getElementById('leaderboard-count').classList.toggle('hidden', !leaderboard.length);
                document.getElementById('review-count').textContent = reviews.length || '0';
                document.getElementById('review-count').classList.toggle('hidden', !reviews.length);
            } catch (err) {
                console.error('Error fetching stats:', err);
                document.getElementById('contact-count').textContent = '0';
                document.getElementById('contact-count').classList.toggle('hidden', true);
                document.getElementById('entry-count').textContent = '0';
                document.getElementById('entry-count').classList.toggle('hidden', true);
                document.getElementById('schedule-count').textContent = '0';
                document.getElementById('schedule-count').classList.toggle('hidden', true);
                document.getElementById('leaderboard-count').textContent = fallbackLeaderboardData.length || '0';
                document.getElementById('leaderboard-count').classList.toggle('hidden', !fallbackLeaderboardData.length);
                document.getElementById('review-count').textContent = '0';
                document.getElementById('review-count').classList.toggle('hidden', true);
            }
        }

        // Contact form handling
        document.getElementById('contact-submit').addEventListener('click', async () => {
            const firstName = document.getElementById('contact-firstName').value.trim();
            const lastName = document.getElementById('contact-lastName').value.trim();
            const email = document.getElementById('contact-email').value.trim();
            const phone = document.getElementById('contact-phone').value.trim();
            const message = document.getElementById('contact-message').value.trim();
            const errorDiv = document.getElementById('contact-error');

            if (!firstName || !lastName || !email || !message) {
                errorDiv.textContent = 'Please provide first name, last name, email, and message';
                errorDiv.classList.remove('hidden');
                document.getElementById('contact-firstName').classList.toggle('input-error', !firstName);
                document.getElementById('contact-lastName').classList.toggle('input-error', !lastName);
                document.getElementById('contact-email').classList.toggle('input-error', !email);
                document.getElementById('contact-message').classList.toggle('input-error', !message);
                return;
            }

            try {
                const response = await fetch('https://sh4nerewards.com/api/contact', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('authToken')}`
                    },
                    body: JSON.stringify({ firstName, lastName, email, phone, message })
                });
                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.error || `Contact API failed: ${response.status}`);
                }
                alert('Contact submitted successfully!');
                document.getElementById('contact-modal').classList.add('hidden');
                document.getElementById('contact-firstName').value = '';
                document.getElementById('contact-lastName').value = '';
                document.getElementById('contact-email').value = '';
                document.getElementById('contact-phone').value = '';
                document.getElementById('contact-message').value = '';
                document.getElementById('contact-error').classList.add('hidden');
                                document.getElementById('contact-firstName').classList.remove('input-error');
                                document.getElementById('contact-lastName').classList.remove('input-error');
                                document.getElementById('contact-email').classList.remove('input-error');
                                document.getElementById('contact-message').classList.remove('input-error');
                            } catch (err) {
                                console.error('Error submitting contact:', err);
                                errorDiv.textContent = err.message || 'Failed to submit contact';
                                errorDiv.classList.remove('hidden');
                            }
                        });
                
                        // Initialize
                        trackVisitor();
                        fetchStats();
                        setInterval(fetchStats, 30000); // Refresh stats every 30 seconds
                    </script>
                </body>
                </html>
          
