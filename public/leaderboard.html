<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://unpkg.com https://cdn.jsdelivr.net;
        style-src 'self' 'unsafe-inline' https://unpkg.com https://fonts.googleapis.com https://fonts.gstatic.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: http://localhost:3000 https://res.cloudinary.com;
        connect-src 'self' http://localhost:3000 https://cdn.jsdelivr.net https://kick.com https://bc.game https://t.me https://youtube.com https://www.instagram.com;
        frame-src 'self' https://www.youtube.com https://youtube.com https://youtu.be https://www.youtube-nocookie.com https://player.vimeo.com https://www.kick.com;
        media-src 'self' sound/;
    ">
    <title>SH4NER | S4R - Leaderboard</title>
    <link rel="preload" href="/font/ACROTERIONJF-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="/font/ACROTERIONJF-Regular.woff" as="font" type="font/woff" crossorigin="anonymous">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=block" rel="stylesheet">
    <link rel="stylesheet" href="/leaderboard.css">
</head>
<body>
    <div class="bg-pattern"></div>

    <!-- Header -->
    <header class="header fixed z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center justify-between">
            <div class="flex items-center w-1/3 left-icons">
                <nav class="flex space-x-4 sm:space-x-6">
                    <a href="index.html" class="text-[#dfefff]/95 uppercase font-semibold text-xs sm:text-sm tracking-wide">Home</a>
                    <a href="leaderboard.html" class="text-[#dfefff]/95 uppercase font-semibold text-xs sm:text-sm tracking-wide nav-active">Leadboard</a>
                    <a href="game.html" class="text-[#dfefff]/95 uppercase font-semibold text-xs sm:text-sm tracking-wide">Gameplay</a>
                    <a href="givaway.html" class="text-[#dfefff]/95 uppercase font-semibold text-xs sm:text-sm tracking-wide">Giveaway</a>
                </nav>
            </div>
            <div class="flex justify-center w-1/3 logo-container">
                <img src="/img/Sh4ner_White 1.png" alt="Logo" class="h-8 sm:h-10 rounded-full object-cover">
            </div>
            <div class="flex items-center space-x-1 sm:space-x-2 w-1/3 justify-end right-icons">
                <a href="https://x.com/sh4ne_r?t=3Uet8-mY59EnhAzmaig5Hw&s=09" target="_blank" aria-label="X" class="feather-icon">
                    <svg class="text-white w-4 h-4 sm:w-5 sm:h-5" viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M 5.9199219 6 L 20.582031 27.375 L 6.2304688 44 L 9.4101562 44 L 21.986328 29.421875 L 31.986328 44 L 44 44 L 28.681641 21.669922 L 42.199219 6 L 39.029297 6 L 27.275391 19.617188 L 17.933594 6 L 5.9199219 6 z M 9.7167969 8 L 16.880859 8 L 40.203125 42 L 33.039062 42 L 9.7167969 8 z"></path>
                    </svg>
                </a>
                <span class="icon-fallback">X</span>
                <a href="https://youtube.com/@sh4neryt?si=mW-9I4vw14vgCbC_" target="_blank" aria-label="YouTube" class="feather-icon"><i data-feather="youtube" class="text-white w-4 h-4 sm:w-5 sm:h-5"></i></a>
                <span class="icon-fallback">YT</span>
                <a href="https://www.instagram.com/s4r.clips?igsh=Z3pyM3hua21qNmI5" target="_blank" aria-label="Instagram" class="feather-icon"><i data-feather="instagram" class="text-white w-4 h-4 sm:w-5 sm:h-5"></i></a>
                <span class="icon-fallback">IG</span>
                <a href="https://t.me/SH4NERLOBBY" target="_blank" aria-label="Telegram" class="feather-icon"><i data-feather="send" class="text-white w-4 h-4 sm:w-5 sm:h-5"></i></a>
                <span class="icon-fallback">TG</span>
                <a href="https://kick.com/sh4ne_r" target="_blank" class="cta-button flex items-center uppercase font-bold tracking-wider">Follow on Kick!</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 sm:pt-32 pb-12 sm:pb-16 relative">
        <section class="mb-8 sm:mb-12" aria-labelledby="leaderboard-heading">
            <h2 id="leaderboard-heading" class="social-heading">S4R | Leaderboard</h2>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center mb-4 sm:mb-6">
                    <h3 class="text-2xl sm:text-3xl font-bold text-white">Leaderboard Wage Race</h3>
                </div>
                <div class="winner-grid" data-aos="fade-up"></div>
                <div class="countdown-card" data-aos="fade-up">
                    <h4 class="text-lg sm:text-xl font-bold text-[#00E0FF] mb-3 sm:mb-4">Time Remaining</h4>
                    <div class="countdown-grid">
                        <div class="countdown-box">
                            <p id="countdown-days" class="text-xl sm:text-2xl font-bold text-white mb-1"></p>
                            <p class="text-xs sm:text-sm text-gray-400">Days</p>
                        </div>
                        <div class="countdown-box">
                            <p id="countdown-hours" class="text-xl sm:text-2xl font-bold text-white mb-1"></p>
                            <p class="text-xs sm:text-sm text-gray-400">Hours</p>
                        </div>
                        <div class="countdown-box">
                            <p id="countdown-minutes" class="text-xl sm:text-2xl font-bold text-white mb-1"></p>
                            <p class="text-xs sm:text-sm text-gray-400">Minutes</p>
                        </div>
                        <div class="countdown-box">
                            <p id="countdown-seconds" class="text-xl sm:text-2xl font-bold text-white mb-1"></p>
                            <p class="text-xs sm:text-sm text-gray-400">Seconds</p>
                        </div>
                    </div>
                </div>
                <table id="leaderboard" class="w-full mt-4 sm:mt-6 overflow-x-auto">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Username</th>
                            <th>Total Wager ($)</th>
                            <th>Prize ($)</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>
       
        <!-- Promo Modal -->
        <div id="promo-modal" class="modal">
            <div class="modal-content">
                <button class="close-modal">&times;</button>
                <img src="/img/Poker Chip Shuffle.gif" alt="Poker Chip Shuffle" class="modal-image">
                <p class="modal-text">Join the SH4NER Action! Grab Your Bonus Now!</p>
                <a href="https://bcgame.st/i-sh4ner-n" target="_blank" class="modal-button">Use Code SH4NE</a>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation (Mobile Only) -->
    <nav class="bottom-nav">
        <a href="index.html"><i data-feather="home"></i>Home</a>
        <a href="leaderboard.html" class="nav-active"><i data-feather="award"></i>Leadboard</a>
        <a href="game.html"><i data-feather="play-circle"></i>Gameplay</a>
        <a href="givaway.html"><i data-feather="gift"></i>Giveaway</a>
    </nav>

    <!-- Floating Kick Button (Mobile Only) -->
    <a href="https://kick.com/sh4ne_r" target="_blank" class="floating-kick-button">Follow on Kick!</a>

    <!-- Floating Help Button (Mobile Only) -->
    <a href="help.html" class="floating-help-button">Help</a>

    <!-- Footer Section -->
    <footer class="footer">
        <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-12 sm:py-16">
            <div class="h-divider">
                <div class="shadow"></div>
            </div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="section-divider w-full mb-8"></div>
                <h2 class="text-[#FFFF00] font-bold text-[48px] text-center font-['Poppins']">Disclaimer</h2>
                <p class="text-[16px] text-center font-['Poppins'] font-normal mt-4 max-w-2xl mx-auto disclaimer-text">
                    sh4ner.com is an independent igaming news site and casino comparison service. Every effort is made to ensure that the bonus offers listed here are accurate and up-to-date. However, we accept no responsibility for inaccuracies or errors. Please check terms and conditions before deciding to take a bonus.
                </p>
                <h1 class="text-[#FF0000] font-bold text-[48px] text-center font-['Poppins'] mt-8">Gamble Responsibly</h1>
                <p class="text-[16px] text-center font-['Poppins'] font-normal mt-4 max-w-2xl mx-auto gamble-text">
                    Please gamble responsibly. Gambling can have a serious impact on your life. Only gamble with money you can afford to lose.
                </p>
                <div class="footer-logo-container">
                    <img src="/img/75a66996c8988a839e73f363914e85fba6db1e10.png" alt="Logo 1" class="footer-logo">
                    <img src="/img/1be4be065fedecbf48f67c6f6b5dc6ffa0b85cfb.png" alt="Logo 2" class="footer-logo">
                    <img src="/img/b787bdceb376f6ca4007ae8c5de2c7bcea17b7ef.png" alt="Logo 3" class="footer-logo">
                    <img src="/img/164ae989bb0b639138196e2074669754ca16ba85.png" alt="Logo 4" class="footer-logo">
                </div>
                <p class="text-[12px] text-center font-['Poppins'] font-normal mt-4">
                    © 2024 SH4NE_R. All rights reserved. 
                    <a href="#" class="underline">Privacy Policy</a> | 
                    <a href="#" class="underline">Terms of Service</a>
                </p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            try {
                feather.replace();
            } catch (e) {
                console.error('Feather Icons failed to load:', e);
                document.querySelectorAll('.feather-icon').forEach(function(el) {
                    el.classList.add('empty');
                });
            }
            AOS.init();

            // Cookie Consent Handling
            const cookieBar = document.getElementById('cookie-bar');
            const cookieAcceptBtn = document.getElementById('cookie-accept');
            const cookiePreferencesBtn = document.getElementById('cookie-preferences');

            if (cookieBar && localStorage.getItem('cookieConsent') === 'accepted') {
                cookieBar.style.display = 'none';
            }

            if (cookieAcceptBtn) {
                cookieAcceptBtn.addEventListener('click', () => {
                    localStorage.setItem('cookieConsent', 'accepted');
                    cookieBar.style.display = 'none';
                });
            }

            if (cookiePreferencesBtn) {
                cookiePreferencesBtn.addEventListener('click', () => {
                    window.location.href = '/cookie-preferences';
                });
            }

            // Scroll Handling for Floating Kick and Help Buttons
            let lastScrollTop = 0;
            let scrollTimeout = null;
            const kickButton = document.querySelector('.floating-kick-button');
            const helpButton = document.querySelector('.floating-help-button');

            function throttle(func, wait) {
                let timeout = null;
                return function() {
                    if (!timeout) {
                        timeout = setTimeout(() => {
                            func.apply(this, arguments);
                            timeout = null;
                        }, wait);
                    }
                };
            }

            const handleScroll = throttle(() => {
                let currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
                if (currentScrollTop > lastScrollTop) {
                    // Scrolling down
                    kickButton.classList.add('hidden');
                    helpButton.classList.add('hidden');
                } else {
                    // Scrolling up
                    kickButton.classList.remove('hidden');
                    helpButton.classList.remove('hidden');
                }
                lastScrollTop = currentScrollTop <= 0 ? 0 : currentScrollTop;

                // Show buttons when scrolling stops
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    kickButton.classList.remove('hidden');
                    helpButton.classList.remove('hidden');
                }, 150);
            }, 100);

            window.addEventListener('scroll', handleScroll);

            // Embedded leaderboard data as fallback
            const fallbackLeaderboardData = [
                { rank: 1, username: "ЖЕ*****ЧУ", totalWager: 243747.58, reward: 3000, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 2, username: "Ma***ts", totalWager: 205427.81, reward: 2000, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 3, username: "Lb*******yb", totalWager: 97128.16, reward: 1000, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 4, username: "El********cc", totalWager: 94694.31, reward: 500, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 5, username: "St********ac", totalWager: 68815, reward: 250, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 6, username: "Ma*****f5", totalWager: 35404.04, reward: 250, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 7, username: "Ki**_K", totalWager: 13919.21, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 8, username: "Ma*****ay", totalWager: 13235.44, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 9, username: "Re**im", totalWager: 11396.51, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 10, username: "Ng******ri", totalWager: 10468.95, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 11, username: "اب***کل", totalWager: 9752.73, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 12, username: "Az******🚬", totalWager: 7833.94, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 13, username: "ᘻᓍ******🎭", totalWager: 6474.33, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 14, username: "Tr******oa", totalWager: 6094.99, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 15, username: "Sa**********te", totalWager: 5830.2, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 16, username: "Bu**********ze", totalWager: 5253.2, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 17, username: "Br***um", totalWager: 4680, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 18, username: "सा************🚩", totalWager: 4331.13, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 19, username: "ih*****fe", totalWager: 4240, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" },
                { rank: 20, username: "La*****25", totalWager: 3588.75, reward: 0, img: "/img/bc-game-esports-logo-png_seeklogo-619973.png" }
            ];

            async function loadLeaderboard() {
                const winnerGrid = document.querySelector('.winner-grid');
                const tbody = document.querySelector("#leaderboard tbody");
                winnerGrid.innerHTML = "";
                tbody.innerHTML = "";

                try {
                    const res = await fetch(`/api/leaderboard?cacheBust=${Date.now()}`);
                    if (!res.ok) throw new Error(`HTTP error: ${res.status} - ${res.statusText}`);
                    const json = await res.json();
                    const players = json.data || [];

                    if (!players.length) {
                        winnerGrid.innerHTML = '<p class="text-center text-sm text-[#c7dfe6]">No leaderboard data available.</p>';
                        tbody.innerHTML = '<tr><td colspan="4" class="text-center text-[#ff5555] italic py-2 text-sm">No data available</td></tr>';
                        throw new Error('No leaderboard data returned from API');
                    }

                    // Sort and get top 3 for winner grid and ranks 4-10 for table
                    const sortedData = [...players].sort((a, b) => (a.rank || Infinity) - (b.rank || Infinity)).map((player, index) => ({ ...player, rank: player.rank || index + 1 }));
                    const topWinners = sortedData.slice(0, 3);
                    const tableData = sortedData.slice(3, 13); // Ranks 4-10
                    const orderedWinners = [
                        topWinners[1], // 2nd (left)
                        topWinners[0], // 1st (middle)
                        topWinners[2]  // 3rd (right)
                    ].filter(winner => winner);

                    // Render top 3 winners in grid
                    orderedWinners.forEach((winner, index) => {
                        const isMiddle = index === 1; // 1st place is middle
                        const rankText = ['2nd', '1st', '3rd'][index] || `${index + 1}th`;
                        const winnerCard = document.createElement('div');
                        winnerCard.className = `winner-card ${isMiddle ? 'middle-card' : ''}`;
                        winnerCard.innerHTML = `
                            <p class="winner-rank">${rankText}</p>
                            <img src="${winner.img || '/img/bc-game-esports-logo-png_seeklogo-619973.png'}" alt="${winner.username || 'Unknown'}" class="winner-avatar">
                            <h4>${winner.username || 'Unknown'}</h4>
                            <img src="/img/Trophy.gif" alt="Trophy" class="trophy-icon">
                            <p class="winning-amount">$${Number(winner.totalWager || 0).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                            <p class="winner-prize">${winner.reward ? '$' + Number(winner.reward).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : ''}</p>
                        `;
                        winnerGrid.appendChild(winnerCard);
                    });

                    // Render ranks 4-10 in table
                    tableData.forEach((p, index) => {
                        const tr = document.createElement("tr");
                        tr.className = (index + 4) % 2 === 0 ? 'bg-[rgba(3,16,22,0.5)]' : '';
                        tr.innerHTML = `
                            <td>${p.rank || index + 4}</td>
                            <td class="flex items-center gap-2">
                                ${p.img ? `<img src="${p.img || '/img/bc-game-esports-logo-png_seeklogo-619973.png'}" class="avatar" alt="Avatar" />` : ''}
                                ${p.username || "Unknown"}
                            </td>
                            <td>$${Number(p.totalWager || 0).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>
                            <td>${p.reward ? '$' + Number(p.reward).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : ''}</td>
                        `;
                        tbody.appendChild(tr);
                    });

                    // Update countdown for end of month
                    const daysElement = document.getElementById('countdown-days');
                    const hoursElement = document.getElementById('countdown-hours');
                    const minutesElement = document.getElementById('countdown-minutes');
                    const secondsElement = document.getElementById('countdown-seconds');
                    if (daysElement && hoursElement && minutesElement && secondsElement) {
                        const countDownDate = new Date('2025-10-31T23:59:59Z').getTime();
                        const countdown = setInterval(() => {
                            const now = new Date().getTime();
                            const distance = countDownDate - now;
                            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                            daysElement.textContent = days.toString().padStart(2, '0');
                            hoursElement.textContent = hours.toString().padStart(2, '0');
                            minutesElement.textContent = minutes.toString().padStart(2, '0');
                            secondsElement.textContent = seconds.toString().padStart(2, '0');
                            if (distance < 0) {
                                clearInterval(countdown);
                                daysElement.textContent = '00';
                                hoursElement.textContent = '00';
                                minutesElement.textContent = '00';
                                secondsElement.textContent = '00';
                            }
                        }, 1000);
                    }

                    // Show modal after leaderboard loads
                    const modal = document.getElementById('promo-modal');
                    modal.style.display = 'flex';
                } catch (err) {
                    console.error("Error loading leaderboard:", err.message);
                    winnerGrid.innerHTML = '<p class="text-center text-sm text-[#c7dfe6]">No leaderboard data available.</p>';
                    tbody.innerHTML = `<tr><td colspan="4" class="text-center text-[#ff5555] italic py-2 text-sm">Error loading data: ${err.message}</td></tr>`;

                    // Use fallback data
                    const sortedData = [...fallbackLeaderboardData].sort((a, b) => (a.rank || Infinity) - (b.rank || Infinity)).map((player, index) => ({ ...player, rank: player.rank || index + 1 }));
                    const topWinners = sortedData.slice(0, 3);
                    const tableData = sortedData.slice(3, 13); // Ranks 4-10
                    const orderedWinners = [
                        topWinners[1], // 2nd (left)
                        topWinners[0], // 1st (middle)
                        topWinners[2]  // 3rd (right)
                    ].filter(winner => winner);

                    orderedWinners.forEach((winner, index) => {
                        const isMiddle = index === 1; // 1st place is middle
                        const rankText = ['2nd', '1st', '3rd'][index] || `${index + 1}th`;
                        const winnerCard = document.createElement('div');
                        winnerCard.className = `winner-card ${isMiddle ? 'middle-card' : ''}`;
                        winnerCard.innerHTML = `
                            <p class="winner-rank">${rankText}</p>
                            <img src="${winner.img || '/img/bc-game-esports-logo-png_seeklogo-619973.png'}" alt="${winner.username || 'Unknown'}" class="winner-avatar">
                            <h4>${winner.username || 'Unknown'}</h4>
                            <img src="/img/Trophy.gif" alt="Trophy" class="trophy-icon">
                            <p class="winning-amount">$${Number(winner.totalWager || 0).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                            <p class="winner-prize">${winner.reward ? '$' + Number(winner.reward).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : ''}</p>
                        `;
                        winnerGrid.appendChild(winnerCard);
                    });

                    tableData.forEach((p, index) => {
                        const tr = document.createElement("tr");
                        tr.className = (index + 4) % 2 === 0 ? 'bg-[rgba(3,16,22,0.5)]' : '';
                        tr.innerHTML = `
                            <td>${p.rank || index + 4}</td>
                            <td class="flex items-center gap-2">
                                ${p.img ? `<img src="${p.img || '/img/bc-game-esports-logo-png_seeklogo-619973.png'}" class="avatar" alt="Avatar" />` : ''}
                                ${p.username || "Unknown"}
                            </td>
                            <td>$${Number(p.totalWager || 0).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>
                            <td>${p.reward ? '$' + Number(p.reward).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : ''}</td>
                        `;
                        tbody.appendChild(tr);
                    });

                    // Update countdown for end of month in fallback
                    const daysElement = document.getElementById('countdown-days');
                    const hoursElement = document.getElementById('countdown-hours');
                    const minutesElement = document.getElementById('countdown-minutes');
                    const secondsElement = document.getElementById('countdown-seconds');
                    if (daysElement && hoursElement && minutesElement && secondsElement) {
                        const countDownDate = new Date('2025-10-31T23:59:59Z').getTime();
                        const countdown = setInterval(() => {
                            const now = new Date().getTime();
                            const distance = countDownDate - now;
                            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                            daysElement.textContent = days.toString().padStart(2, '0');
                            hoursElement.textContent = hours.toString().padStart(2, '0');
                            minutesElement.textContent = minutes.toString().padStart(2, '0');
                            secondsElement.textContent = seconds.toString().padStart(2, '0');
                            if (distance < 0) {
                                clearInterval(countdown);
                                daysElement.textContent = '00';
                                hoursElement.textContent = '00';
                                minutesElement.textContent = '00';
                                secondsElement.textContent = '00';
                            }
                        }, 1000);
                    }

                    // Show modal after leaderboard loads
                    const modal = document.getElementById('promo-modal');
                    modal.style.display = 'flex';
                }
            }

            // Modal close functionality
            const modal = document.getElementById('promo-modal');
            const closeBtn = document.querySelector('.close-modal');
            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.style.display = 'none';
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal.style.display === 'flex') modal.style.display = 'none';
            });

            // Initial load and refresh every 4 minutes
            loadLeaderboard();
            setInterval(loadLeaderboard, 240000);
        });
    </script>
</body>
</html>
